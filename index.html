<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sequential Random Buttons</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            position: relative;
        }

        #container {
            position: relative;
            height: 90vh;
            width: 100%;
            /* Ensure the container takes full width */
        }

        .random-image {
            position: absolute;
            transition: top 0.5s, left 0.5s;
            /* Smooth transition for image movement */
            width: 150px;
            /* Adjust the width as needed */
            height: auto;
            /* Maintain aspect ratio */
        }

        #score {
            position: absolute;
            top: 10px;
            left: 10px;
            font-weight: bold;
        }

        #fail-message {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            color: red;
            display: none;
        }

        #view-reward {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            color: green;
            display: none;
        }

        #restart-button {
            position: absolute;
            top: 70%;
            left: 50%;
            transform: translateX(-50%);
            display: none;
        }
    </style>
</head>

<body>
    <div id="container" class="container-fluid">
        <img id="image1" src="" class="random-image" alt="Image 1">
        <div id="score">Score: 0</div>
        <div id="fail-message" class="pb-4">You failed, you need at least 7 points to claim your reward<br><button
                id="restart-button" class="btn btn-secondary mt-5">Restart</button></div>
        <button id="view-reward" class="btn btn-lg btn-success">View your reward</button>
    </div>

    <!-- Add cute music -->
    <audio id="cute-music" loop autoplay>
        <source src="cute_music.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <script>
        const container = document.getElementById('container');
        const scoreElement = document.getElementById('score');
        const viewRewardButton = document.getElementById('view-reward');
        const failMessage = document.getElementById('fail-message');
        const restartButton = document.getElementById('restart-button');
        const cuteMusic = document.getElementById('cute-music'); // Get the audio element
        let score = 0;
        let buttonCount = 1; // Start with the first button
        let usedImages = []; // Array to store used image numbers

        // Add event listener to the document body
        document.body.addEventListener('click', function (event) {
            // Check if the clicked element is not the image or its descendants
            if (!event.target.closest('.random-image')) {
                score--;
                scoreElement.textContent = 'Score: ' + score;
            }
        });

        function moveImageRandomly(image) {
            const maxX = container.clientWidth - image.width;
            const maxY = container.clientHeight - image.height;
            const randomX = Math.floor(Math.random() * maxX);
            const randomY = Math.floor(Math.random() * maxY);
            image.style.left = randomX + 'px';
            image.style.top = randomY + 'px';
        }

        function createNextImage(prevImage, imageNumber) {
            if (buttonCount >= 10) {
                // Stop creating images after 10
                prevImage.remove();
                if (score >= 7) {
                    viewRewardButton.style.display = 'block';
                    restartButton.style.display = 'block'; // Show restart button if won
                } else {
                    failMessage.style.display = 'block';
                    restartButton.style.display = 'block'; // Show restart button if failed
                }
                scoreElement.style.display = 'none'; // Hide score
                return;
            }

            buttonCount++; // Increment to track image creation
            let randomImageNumber;
            do {
                randomImageNumber = Math.floor(Math.random() * 10) + 1; // Generate random image number
            } while (usedImages.includes(randomImageNumber)); // Check if image number is already used
            usedImages.push(randomImageNumber); // Add the image number to usedImages array
            const newImage = new Image();
            newImage.className = 'random-image';
            newImage.src = 'image' + randomImageNumber + '.png';
            newImage.alt = 'Image ' + randomImageNumber;
            newImage.id = 'image' + randomImageNumber;

            newImage.addEventListener('click', function () {
                score++;
                scoreElement.textContent = 'Score: ' + score;
                createNextImage(this, imageNumber + 1); // Pass this image and next image number
            });

            container.insertBefore(newImage, failMessage); // Insert new image before the fail message
            moveImageRandomly(newImage);
            prevImage.remove(); // Remove the previous image
        }

        // Generate a random image number for the first image
        let firstImageNumber;
        do {
            firstImageNumber = Math.floor(Math.random() * 10) + 1;
        } while (usedImages.includes(firstImageNumber)); // Ensure the first image is not repeated
        usedImages.push(firstImageNumber);
        document.getElementById('image1').src = 'image' + firstImageNumber + '.png';
        document.getElementById('image1').alt = 'Image ' + firstImageNumber;

        document.getElementById('image1').addEventListener('click', function () {
            score++;
            scoreElement.textContent = 'Score: ' + score;
            createNextImage(this, 2); // Start the chain by clicking the first image
        });

        // Initially place the first image at a random position
        moveImageRandomly(document.getElementById('image1'));

        // Add event listener to the view reward button
        viewRewardButton.addEventListener('click', function () {
            alert('Congratulations! You passed!');
            // Add code to show the reward or perform other actions
        });

        // Add event listener to the restart button
        restartButton.addEventListener('click', function () {
            location.reload(); // Reload the page to restart
        });
    </script>
</body>

</html>
